<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lakozy Toyota Prize Wheel</title>
<style>
body {
  margin:0;
  height:100vh;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  background: linear-gradient(135deg, #660000, #b30000);
  font-family: Arial, sans-serif;
  overflow:hidden;
}

.wheel-container {
  position: relative;
  width: 90vw;   /* responsive */
  max-width: 550px;
  aspect-ratio: 1/1; /* keeps it square */
}

canvas {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  box-shadow: 0 0 40px rgba(255, 215, 0, 0.6), inset 0 0 20px rgba(255, 255, 255, 0.3);
  background: radial-gradient(circle at center, #fffbe6 0%, #ffd700 100%);
}

.spin-button {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  padding: 12px 24px;
  background: linear-gradient(145deg, #ffcc00, #ffd700);
  border: none;
  border-radius: 50px;
  font-size: clamp(14px, 3vw, 20px);
  font-weight: bold;
  color: #660000;
  cursor: pointer;
  box-shadow: 0 5px 15px rgba(0,0,0,0.5);
  z-index: 2;
  transition: 0.2s;
}
.spin-button:hover {
  transform: translate(-50%, -50%) scale(1.05);
  background: linear-gradient(145deg, #ffd700, #ffcc00);
}

.pointer {
  position: absolute;
  top: -6%;
  left: 50%;
  transform: translateX(-50%);
  width: 0;
  height: 0;
  border-left: 6% solid transparent;
  border-right: 6% solid transparent;
  border-bottom: 12% solid gold;
  filter: drop-shadow(0px 0px 5px #ffcc00);
  z-index: 2;
}

.wheel-text {
  margin-top: 20px;
  font-size: clamp(16px, 4vw, 24px);
  color: gold;
  font-weight: bold;
  text-shadow: 0 0 8px #ffd700;
  text-align:center;
}

/* Winner overlay */
.winner-overlay {
  position: fixed;
  inset:0;
  background: rgba(0,0,0,0.85);
  display:flex;
  justify-content:center;
  align-items:center;
  color:white;
  font-size:2rem;
  font-weight:bold;
  flex-direction:column;
  z-index:5;
  display:none;
  text-align:center;
  padding: 20px;
}

.winner-overlay span {
  font-size: 1.2rem;
  margin-top:10px;
  color: gold;
}

.winner-overlay button {
  margin-top:20px;
  padding:12px 24px;
  font-size:1rem;
  background:#ffd700;
  border:none;
  border-radius:8px;
  cursor:pointer;
  font-weight:bold;
  color:#660000;
}

.confetti {
  position: fixed;
  width: 10px;
  height: 10px;
  background: gold;
  opacity: 0.7;
  pointer-events: none;
  animation: fall 2s linear infinite;
}

@keyframes fall {
  0% {transform: translateY(0) rotate(0deg);}
  100% {transform: translateY(100vh) rotate(360deg);}
}
</style>
</head>
<body>

<div class="wheel-container">
  <div class="pointer"></div>
  <canvas id="wheel"></canvas>
  <button class="spin-button" onclick="spin()">SPIN</button>
</div>

<div class="wheel-text">Spin & Win with Lakozy Toyota</div>

<div class="winner-overlay" id="winnerOverlay">
  <div id="winnerText">ðŸŽ‰ Congratulations!</div>
  <span id="winnerPrize"></span>
  <button onclick="closeOverlay()">Close</button>
</div>

<script>
const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");

// dynamically match canvas size to container
function resizeCanvas() {
  const rect = canvas.parentElement.getBoundingClientRect();
  canvas.width = rect.width;
  canvas.height = rect.height;
  drawWheel();
}
window.addEventListener("resize", resizeCanvas);

const prizes = [
  { label:"Smart Watch", img:"images/watch.png" },  
  { label:"Speaker", img:"images/speaker1.jpg" },
  { label:"Sound Bar", img:"images/karaoke.png" },
  { label:"Car Refrigerator", img:"images/fridge.jpg" },
  { label:"Karaoke System", img:"images/speaker2.png" },
  { label:"Full Tank Fuel", img:"images/fuel.jpg" },
  { label:'32" LED TV', img:"images/tv.jpg" },
  { label:"Luxury Spa ", img:"images/spa.jpg" },
  { label:"1g Gold Coin", img:"images/gold.avif" }
];

const colors = ["#b30000","#ffd700"];
let startAngle=0;
let arc;
function drawWheel(){
  const size = canvas.width;
  const center = size/2;
  arc=(2*Math.PI)/prizes.length;
  ctx.clearRect(0,0,canvas.width,canvas.height);

  for(let i=0;i<prizes.length;i++){
    const angle=startAngle + i*arc;
    const gradient=ctx.createLinearGradient(0,0,canvas.width,canvas.height);
    gradient.addColorStop(0, colors[i%colors.length]);
    gradient.addColorStop(1, "#ffdd66");
    ctx.fillStyle=gradient;

    ctx.beginPath();
    ctx.moveTo(center,center);
    ctx.arc(center,center,center,angle,angle+arc);
    ctx.closePath();
    ctx.fill();

    // Draw image + text side by side
    const img = new Image();
    img.src = prizes[i].img;
    ((angleLocal, imgLocal, prizeLabel) => {
      imgLocal.onload = function() {
        ctx.save();
        ctx.translate(center,center);
        ctx.rotate(angleLocal + arc/2);

        const radius = size*0.25;
        const imgSize = size*0.1;
        ctx.drawImage(imgLocal, radius - imgSize/2, -imgSize/2, imgSize, imgSize);

        const textX = radius + imgSize*0.6;
        const textY = imgSize*0.3;
        ctx.fillStyle = "#660000";
        ctx.font = `bold ${Math.floor(size*0.025)}px Arial`;
        ctx.textAlign = "left";
        ctx.shadowColor = "#FFD700";
        ctx.shadowBlur = 4;
        ctx.fillText(prizeLabel, textX, textY);

        ctx.shadowBlur = 0;
        ctx.restore();
      }
    })(angle, img, prizes[i].label);
  }

  // Center hub
  ctx.beginPath();
  ctx.arc(center,center,size*0.09,0,2*Math.PI);
  ctx.fillStyle="#ffd700";
  ctx.shadowColor="#ffcc00";
  ctx.shadowBlur=15;
  ctx.fill();
}
resizeCanvas();

let spinAngle=0;
let spinTime=0;
let spinTimeTotal=0;
let isSpinning = false; // flag

const forcedPrizes=["Smart Watch","Speaker","Luxury Spa ","Full Tank Fuel"];

function spin(){
  if (isSpinning) return;
  isSpinning = true;

  const chosenPrize = forcedPrizes[Math.floor(Math.random()*forcedPrizes.length)];
  const idx = prizes.findIndex(p=>p.label===chosenPrize);
  const prizeAngle = idx*arc + arc/2;
  const finalAngle = 2*Math.PI*5 + (2*Math.PI - prizeAngle);

  spinAngle = finalAngle;
  spinTime = 0;
  spinTimeTotal = 4000;

  rotateWheel(idx);
}

function rotateWheel(finalIndex){
  spinTime += 30;
  if(spinTime >= spinTimeTotal){
    showWinner(prizes[finalIndex].label, prizes[finalIndex].img);
    isSpinning = false;
    return;
  }
  const easeOut = easeOutCubic(spinTime, 0, spinAngle, spinTimeTotal);
  startAngle += easeOut / 100;
  drawWheel();
  requestAnimationFrame(()=>rotateWheel(finalIndex));
}

function easeOutCubic(t,b,c,d){
  t/=d; t--;
  return c*(t*t*t+1)+b;
}

function showWinner(prize,imgSrc){
  const overlay=document.getElementById("winnerOverlay");
  document.getElementById("winnerPrize").innerHTML=
    `<img src="${imgSrc}" width="80" style="margin-bottom:10px;"><br>You won: ${prize}`;
  overlay.style.display="flex";
  createConfetti();

}

function closeOverlay(){
  document.getElementById("winnerOverlay").style.display="none";
  removeConfetti();
  isSpinning = false;
}

let confettiElements=[];
function createConfetti(){
  for(let i=0;i<80;i++){
    const conf=document.createElement("div");
    conf.className="confetti";
    conf.style.left=Math.random()*window.innerWidth+"px";
    conf.style.backgroundColor=`hsl(${Math.random()*50+40},100%,50%)`;
    conf.style.animationDuration=(Math.random()*2+2)+"s";
    document.body.appendChild(conf);
    confettiElements.push(conf);
  }
}
function removeConfetti(){
  confettiElements.forEach(c=>c.remove());
  confettiElements=[];
}
</script>

</body>
</html>
